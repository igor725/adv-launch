"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}!function(t){var e=function(){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if(_classCallCheck(this,n),!t||"object"!==_typeof(t)||Array.isArray(t))throw new Error("[TranslatorJS] Invalid dictionary object.");if("string"!=typeof e)throw new Error("[TranslatorJS] Invalid language key, expected “string” by recieved “".concat(_typeof(e),"”."));if(!t.hasOwnProperty(e)&&0<e.length)throw new Error("[TranslatorJS] Invalid language key, “".concat(e,"” does not exist in the passed dictionary."));this.dictionary=t||{},this.language=e||("object"===("undefined"==typeof document?"undefined":_typeof(document))?document.documentElement.lang:"en")||"en"}return _createClass(n,[{key:"dictionary",set:function(t){if(!t||"object"!==_typeof(t)||Array.isArray(t))throw new Error("[TranslatorJS] Invalid dictionary object.");this._dictionary=t},get:function(){return this._dictionary}},{key:"language",set:function(t){if("string"!=typeof t)throw new Error("[TranslatorJS] Invalid language key, expected “string” by recieved “".concat(_typeof(t),"”."));if(!this.dictionary.hasOwnProperty(t)&&0<Object.keys(this.dictionary).length&&0<t.length)throw new Error("[TranslatorJS] Invalid language key, “".concat(_typeof(t),"” does not exist in the dictionary."));this._language=t},get:function(){return this._language}},{key:"languages",get:function(){return this.dictionary?Object.keys(this.dictionary):[]}}]),_createClass(n,[{key:"translate",value:function(){var n,r,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=e.lang||this.language,i=e.fallback||t,o=e.params||{},l=t.split(".").filter(function(t){return 0<t.length});if(this.isValidLanguage(a)){var s=this.dictionary.hasOwnProperty(this.language);return s&&(s=1<l.length?function(t,e,n){var r=t[e],a=!0,i=!1,o=void 0;try{for(var l,s=n[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var u=l.value;if(!(r=r[u]||void 0))break}}catch(t){i=!0,o=t}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return r}(this.dictionary,a,l):this.dictionary[a][t]),s?(n=s,r=o,Object.keys(r).forEach(function(t){var e=new RegExp("{".concat(t,"}"),"g");n=n.replace(e,r[t])}),n):i}return i}},{key:"translateElement",value:function(t,e){if(t){var n=e||this.language,r=t.attributes["eo-translator"].value||t.textContent||t.innerText||t.innerHTML,a=(t.attributes["eo-translator-fallback"]||{value:r}).value,i=JSON.parse((t.attributes["eo-translator-params"]||{value:"{}"}).value)||{};t[!(!t.attributes["eo-translator-html"]||!["true","false"].includes(t.attributes["eo-translator-html"].value))&&!0===JSON.parse(t.attributes["eo-translator-html"].value)?"innerHTML":"textContent"]=this.translate(r,{lang:n,fallback:a,params:i})}}},{key:"translateDOM",value:function(t,e){var n=this,r=e||this.language,a=t||"object"===("undefined"==typeof document?"undefined":_typeof(document))?document:null;a&&a.querySelectorAll("[eo-translator]").forEach(function(t){return n.translateElement(t,r)})}},{key:"add",value:function(t,e,n){var r=e.split(".").filter(function(t){return 0<t.length}),a=r.pop();this.dictionary.hasOwnProperty(t)||(this.dictionary[t]={});var i=this.dictionary[t];if(0<r.length)for(var o=Object.entries(r),l=0;l<o.length;l++){var s=_slicedToArray(o[l],2),u=s[0],c=s[1];if(!(i=i[c]||(i[c]={})))break;parseInt(u)===r.length-1&&(i[a]=n)}else i[e]=n}},{key:"remove",value:function(t,e){var n=e.split(".").filter(function(t){return 0<t.length}),r=n.pop();if(this.dictionary.hasOwnProperty(t)){var a=this.dictionary[t];if(0<n.length)for(var i=Object.entries(n),o=0;o<i.length;o++){var l=_slicedToArray(i[o],2),s=l[0];if(!(a=a[l[1]]))break;parseInt(s)===n.length-1&&delete a[r]}else delete a[e]}}},{key:"isValidLanguage",value:function(t){return this.dictionary.hasOwnProperty(t)}}]),n}();"undefined"!=typeof module&&void 0!==module.exports?module.exports=e:"function"==typeof define&&define.amd?define([],function(){return e}):window.EOTranslator=e}("undefined"!=typeof window&&window);